<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <html>
    <title>Quickly Formed</title>

    <link href="./includes/bootstrap5.2.min.css"" rel=" stylesheet">
    <script src="./includes/bootstrap.bundle5.2.min.js"></script>

    <script src='./js/qfHTMLForms.js' defer></script>
    <script src='./js/qfModal.js' defer></script>
    <script src='./js/qfState.js' defer></script>

    <script src='./includes/alpine.js' defer></script>

    <meta name="theme-color" content="#712cf9">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.min.css">

    <style>
        body {
            min-height: 75rem;
            padding-top: 4.5rem;
        }

        .bd-placeholder-img {
            font-size: 1.125rem;
            text-anchor: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            user-select: none;
        }

        @media (min-width: 768px) {
            .bd-placeholder-img-lg {
                font-size: 3.5rem;
            }
        }

        .b-example-divider {
            height: 3rem;
            background-color: rgba(0, 0, 0, .1);
            border: solid rgba(0, 0, 0, .15);
            border-width: 1px 0;
            box-shadow: inset 0 .5em 1.5em rgba(0, 0, 0, .1), inset 0 .125em .5em rgba(0, 0, 0, .15);
        }

        .b-example-vr {
            flex-shrink: 0;
            width: 1.5rem;
            height: 100vh;
        }

        .bi {
            vertical-align: -.125em;
            fill: currentColor;
        }

        .nav-scroller {
            position: relative;
            z-index: 2;
            height: 2.75rem;
            overflow-y: hidden;
        }

        .nav-scroller .nav {
            display: flex;
            flex-wrap: nowrap;
            padding-bottom: 1rem;
            margin-top: -1px;
            overflow-x: auto;
            text-align: center;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
        }

        masonryFigure {
            margin: 0;
            display: grid;
            grid-template-rows: 1fr auto;
            margin-bottom: 10px;
            break-inside: avoid;
        }

        masonryFigure>img {
            max-width: 100%;
            display: block;
            grid-row: 1 / -1;
            grid-column: 1;
        }

        .masonryContainer {
            column-count: 2;
            column-gap: 5px;
            border: 1px solid #fff;
            background: #fff;
        }
    </style>
</head>

<body>
    <div x-data="qfState">
        <div x-data="qfHTMLForms">
            <div x-data="qfModal">

                <!-- Modal -->
                <div class="modal fade" id="dataModal" tabindex="-1" aria-labelledby="dataModalLabel"
                    aria-hidden="true">
                    <div class="modal-dialog modal-fullscreen ">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="dataModalLabel" x-html="modalData.title""></h5>
                                <button type=" button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                                    </button>
                            </div>
                            <div class="modal-body">
                                <div id="modalData" x-html="modalData.Form.formHTML"></div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                <button @click="getModalFormSave" type="button" class="btn btn-primary"
                                    data-bs-dismiss="modal">Save changes</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- End Modal-->

                <div align="center">

                    <!-- Main Navigation Bar -->
                    <nav class="navbar navbar-expand-sm navbar-dark fixed-top bg-dark">
                        <div class="container-fluid">
                            <!--
                            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                                data-bs-target="#navbarCollapse" aria-controls="navbarTogglerDemo01"
                                aria-expanded="false" aria-label="Toggle navigation">
                                <span class="navbar-toggler-icon"></span>
                            </button>
                            -->

                            <div class="navbar-brand">
                                <a style="color: #fff;" @click="switchProject(-1)" href="#"><i class="bi bi-house"
                                        style="font-size: 1.7rem;"></i></a>
                                &nbsp;&nbsp;
                                <a href="#" style="color: #fff;" @click="switchProject(getCurrentProjectID())">
                                    <span x-text="getCurrentProjectName()"></span></a>
                                <span x-show="isProjectTableSelected()">--> <span
                                        x-text="getCurrentProjectTableName()"></span></span>
                            </div>

                            <!--            
                            <div class="collapse navbar-collapse" id="navbarCollapse">
                                <ul class="navbar-nav me-auto mb-2 mb-md-0">
                                    <li class="nav-item">
                                        <a class="nav-link" aria-current="page" id="nav-link-home"
                                            @click="switchSection('home')" href="#"><i class="bi bi-house" style="font-size: 1.7rem;"></i></a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" aria-current="page" id="nav-link-projects"
                                            @click="switchSection('projects')" href="#">projects</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" href="#" aria-current="page" id="nav-link-design"
                                            @click="switchSection('design')">Design</a>
                                    </li>
                                </ul>
                            </div>
                            -->
                        </div>
                    </nav>
                    <!-- End Main Navigation Bar -->

                    <!-- Home Section -->
                    <div id="home-container" x-show="getInterfaceSection()=='home'"
                        style="margin:0,auto;text-align:left;width:90%">
                        <h5>Projects</h5>
                        <style>
                            h5 {
                                text-decoration: none;
                                color: #333;
                                font-weight: bold;
                            }

                            a {
                                color: #333;
                                text-decoration: none;
                            }

                            a:hover {
                                color: #333;
                                ;
                                text-decoration: underline;
                            }

                            .subtext {
                                color: #999;
                                font-size: 13px;
                                font-weight: bold;
                                text-decoration: none;
                            }

                            .project h5 {
                                color: #800;
                                font-weight: bold;
                                text-decoration: none;
                            }

                            .project h5 a:hover {
                                text-decoration: none;
                            }
                        </style>
                        <div>
                            <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-3 g-4">
                                <template x-for="(project, index) in getProjects()">
                                    <div class="col">
                                        <a href="#" class="project card" @click="switchProject(index)">
                                            <div class="card-body">
                                                <h5 x-text="project.meta.name"></h5>
                                                <div x-text="project.meta.description"></div>
                                                <div class="subtext" x-text="getProjectTotalDataCounts(index)"></div>

                                            </div>
                                        </a>
                                    </div>
                                </template>
                                <div class="col">
                                    <a href="#"
                                        @click="showModal('Create Project', editProjectCreateJSON, 'this.modalFormCreateProject')"
                                        class="project card">
                                        <div class="card-body">
                                            <h5>+ Add Project</h5>
                                        </div>
                                    </a>
                                </div>

                            </div>
                        </div>
                    </div>
                    <!-- End Home Section -->

                    <!-- Project Section -->
                    <div id="projects-container" x-show="getInterfaceSection()=='projects'"
                        style="margin:0,auto;text-align:left;width:90%">

                        <!-- Project Details -->
                        <template x-if="isProjectSelected() && !isProjectTableSelected()">
                            <div>
                                <nav>
                                    <div class="nav nav-tabs" id="nav-project-tab" role="tablist"
                                        style="margin-bottom:15px;">
                                        <button class="nav-link active" id="nav-project-forms-tab" data-bs-toggle="tab"
                                            data-bs-target="#nav-project-forms" type="button" role="tab"
                                            aria-controls="nav-project-forms" aria-selected="true">Forms</button>
                                        <button class="nav-link" id="nav-project-enumerators-tab" data-bs-toggle="tab"
                                            data-bs-target="#nav-project-enumerators" type="button" role="tab"
                                            aria-controls="nav-project-enumerators"
                                            aria-selected="true">Enumerators</button>
                                        <button class="nav-link" id="nav-project-meta-tab" data-bs-toggle="tab"
                                            data-bs-target="#nav-project-meta" type="button" role="tab"
                                            aria-controls="nav-project-meta" aria-selected="true">Meta</button>
                                    </div>
                                </nav>

                                <div class="tab-content" id="nav-tabProjectContent">
                                    <div class="tab-pane fade show active" id="nav-project-forms" role="tabpanel"
                                        aria-labelledby="nav-project-forms">

                                        <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-3 g-4">
                                            <template x-for="(form, index) in getCurrentProjectTables()">
                                                <div class="col">
                                                    <a href="#" @click="projectSwitchTable(index)" class="project card">
                                                        <div class="card-body">
                                                            <h5 x-text="form.meta.name"></h5>
                                                            <div x-text="form.meta.description"></div>
                                                        </div>
                                                    </a>
                                                </div>
                                            </template>
                                            <div class="col">
                                                <a href="#"
                                                    @click="showModal('Create Form', editProjectTableCreateJSON, 'this.modalFormCreateProjectForm')"
                                                    class="project card">
                                                    <div class="card-body">
                                                        <h5>+ Add Form</h5>
                                                    </div>
                                                </a>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="tab-pane fade" id="nav-project-enumerators" role="tabpanel"
                                        aria-labelledby="nav-project-enumerators-tab">
                                        [[Enumerators]]
                                    </div>

                                    <div class="tab-pane fade" id="nav-project-meta" role="tabpanel"
                                        aria-labelledby="nav-project-meta-tab">
                                        <h5>Project Settings</h5>
                                        <template x-if="isProjectSelected()">
                                            <form id="projectmetaform" class="row g-3">
                                                <div class="col-md-12"><label for="projectname" class="form-label">
                                                        project name</label><input :value="getCurrentProjectName()"
                                                        type="text" class="form-control" id="projectname" value=""
                                                        placeholder="">
                                                </div>
                                                <div class="col-md-12"><label for="projectdesc" class="form-label">
                                                        description</label><input
                                                        :value="getCurrentProjectDescription()" type="text"
                                                        class="form-control" id="projectdesc" value="" placeholder="">
                                                </div>
                                                <div class="col-md-12"><button
                                                        @click="saveProjectMetaInfo">Save</button></div>
                                            </form>
                                        </template>
                                    </div>
                                </div>
                            </div>
                        </template>
                        <!-- End Project Details -->

                        <!-- Project Form Details -->
                        <template x-if="isProjectSelected() && isProjectTableSelected()">
                            <div>
                                <nav>
                                    <div class="nav nav-tabs" id="nav-table-tab" role="tablist">
                                        <button class="nav-link active" id="nav-table-design-tab" data-bs-toggle="tab"
                                            data-bs-target="#nav-table-design" type="button" role="tab"
                                            aria-controls="nav-table-design" aria-selected="true">Design</button>
                                        <button class="nav-link" id="nav-table-data-tab" data-bs-toggle="tab"
                                            data-bs-target="#nav-table-data" type="button" role="tab"
                                            aria-controls="nav-table-data" aria-selected="true">Data</button>
                                        <button class="nav-link" id="nav-table-view-tab" data-bs-toggle="tab"
                                            data-bs-target="#nav-table-view" type="button" role="tab"
                                            aria-controls="nav-table-view" aria-selected="true">View</button>
                                        <button class="nav-link" id="nav-table-meta-tab" data-bs-toggle="tab"
                                            data-bs-target="#nav-table-meta" type="button" role="tab"
                                            aria-controls="nav-table-meta" aria-selected="true">Meta</button>
                                    </div>
                                </nav>
                                <div class="tab-content" id="nav-tabContent">
                                    <div class="tab-pane fade show active" id="nav-table-design" role="tabpanel"
                                        aria-labelledby="nav-table-design-tab">
                                        <div align="right">
                                            <button
                                                @click="showModal('Form Preview', getCurrentProjectTableJSON(), 'this.modalPreviewForm', -1)"
                                                type="button" class="btn btn-primary" data-toggle="tooltip"
                                                data-placement="left" title="Preview Form">
                                                <i class="bi bi-grid-3x3"></i>
                                            </button>
                                        </div>

                                        <table class="table table-striped">
                                            <thead>
                                                <tr>
                                                    <th scope="col">name</th>
                                                    <th scope="col">type</th>
                                                    <th scope="col">columns</th>
                                                    <th class="d-none d-lg-table-cell" scope="col">options</th>
                                                    <th scope="col"></th>
                                                    <th scope="col"></th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <template x-show="isProjectTableSelected()"
                                                    x-for="(field, index) in getCurrentProjectTableJSON">
                                                    <tr>
                                                        <td x-text="field.label"></td>
                                                        <td x-text="field.type"></td>
                                                        <td x-text="field.columns"></td>
                                                        <td class="d-none d-lg-table-cell" x-text="field.options"></td>
                                                        <td><i @click="showModal('Edit Field', editFieldJSON, 'this.modalFormSaveFieldEdit', index, field)"
                                                                class="bi-pencil-square"></i></td>
                                                        <td><i @click="deleteFormField(index)" class="bi-trash"></i>
                                                        </td>
                                                    </tr>
                                                </template>
                                            </tbody>
                                        </table>

                                        <p>&nbsp;</p>
                                        <h5>Add New Field</h5>
                                        <form id="addField" class="row g-3">
                                            <div class="col-sm-4"><label for="name"
                                                    class="form-label">name</label><input type="text"
                                                    class="form-control" id="name" value="" placeholder="">
                                            </div>
                                            <div class="col-sm-2"><label for="type"
                                                    class="form-label">type</label><select class="form-select" id="type"
                                                    x-model="qfState.fieldType">
                                                    <template x-for="(type) in fieldTypes">
                                                        <option :value="type" x-text="type"></option>
                                                    </template>
                                                </select></div>
                                            <div class="col-sm-2"><label for="columns"
                                                    class="form-label">size</label><select class="form-select"
                                                    id="columns">
                                                    <option disabled value="">Choose One...</option>
                                                    <option>1</option>
                                                    <option>2</option>
                                                    <option>3</option>
                                                    <option>4</option>
                                                    <option>5</option>
                                                    <option>6</option>
                                                    <option>7</option>
                                                    <option>8</option>
                                                    <option>9</option>
                                                    <option>10</option>
                                                    <option>11</option>
                                                    <option>12</option>
                                                </select></div>

                                            <div class="col-sm-4"><label for="options"
                                                    class="form-label">options</label><input type="text"
                                                    class="form-control" id="options" value=""
                                                    placeholder="use for select or radio"></div>

                                            <div x-show="qfState.fieldType === 'relation'" class="col-sm-4"><label
                                                    for="linktables" class="form-label">link
                                                    table</label><select class="form-select" id="linktable"
                                                    x-model="qfState.linkTableSelected">
                                                    <option value="">Select a Link Table</option>
                                                    <template
                                                        x-for="(table, index) in getCurrentProjectTablesNotSelected()">
                                                        <option :value="table.id" x-text="table.meta.name"></option>
                                                    </template>
                                                </select></div>
                                            <div x-show="qfState.fieldType === 'relation' && qfState.linkTableSelected"
                                                class="col-sm-4"><label for="linktablefields" class="form-label">link
                                                    field</label><select class="form-select" id="linktablefield">
                                                    <template x-for="(field, index) in getCurrentLinkTableFields()">
                                                        <option :value="index" x-text="field.label"></option>
                                                    </template>
                                                </select></div>
                                            <div x-show="qfState.fieldType === 'relation' && qfState.linkTableSelected"
                                                class="col-sm-4"><label for="linktablefields" class="form-label">link
                                                    type</label><select class="form-select" id="linktype">
                                                    <option value="onetoone">one to one</option>
                                                    <option value="onetomany">one to many</option>
                                                </select></div>

                                            <div class="col-md-12"><button @click="tableAddField">Add</button></div>
                                        </form>
                                    </div>

                                    <div class="tab-pane fade" id="nav-table-data" role="tabpanel"
                                        aria-labelledby="nav-table-data">
                                        <!-- Button trigger modal -->
                                        <div align="right">
                                            <button
                                                @click="showModal('Add Record', getCurrentProjectTableJSON(), 'this.modalSaveDataRecord', -1)"
                                                type="button" class="btn btn-primary" data-toggle="tooltip"
                                                data-placement="left" title="Add Record">
                                                <i class="bi bi-plus-circle"></i>
                                            </button>
                                            <button
                                                @click="showModal('Upload File', editFileUploadJSON, 'this.modalUploadFile', -1)"
                                                type="button" class="btn btn-primary" data-toggle="tooltip"
                                                data-placement="left" title="Upload File">
                                                <i class="bi bi-upload"></i>
                                            </button>
                                            <button
                                                @click="downloadCurrentProjectDataJSON()"
                                                type="button" class="btn btn-primary" data-toggle="tooltip"
                                                data-placement="left" title="Download JSON">
                                                <i class="bi bi-download"></i>
                                            </button>
                                        </div>

                                        <div align="center" x-show="getDataListPageCount() > 1">
                                            <button @click="updateCurrentDataListPage(-1)" type="button"
                                                class="btn btn-primary" data-toggle="tooltip"
                                                data-placement="left" title="Previous Page">
                                                <i class="bi bi-arrow-left-circle"></i>
                                            </button>

                                            Page <span x-html="qfState.interface.currentDataListPage"></span> of
                                            <span x-html="getDataListPageCount()"></span>

                                            <button @click="updateCurrentDataListPage(1)" type="button"
                                                class="btn btn-primary" data-toggle="tooltip"
                                                data-placement="left" title="Next Page">
                                                <i class="bi bi-arrow-right-circle"></i></button>
                                        </div>
                                        <div>
                                            <template x-if="isProjectTableSelected()">
                                                <ul class="list-group">
                                                    <template x-show="isProjectTableSelected()"
                                                        x-for="(record, index) in getCurrentProjectTableData()">
                                                        <li
                                                            class="list-group-item d-flex justify-content-between align-items-start">
                                                            <a href="#"
                                                                @click="showModal('Edit Record', getCurrentProjectTableJSON(), 'this.modalSaveDataRecord', index, record)"
                                                                x-text="getGoodDisplayName(record, index)"></a>
                                                            <a href="#"><i @click="deleteDataRecord(index)"
                                                                    class="bi-trash"></i></a>
                                                        </li>
                                                    </template>
                                                </ul>
                                            </template>

                                        </div>
                                    </div>

                                    <div class="tab-pane fade" id="nav-table-view" role="tabpanel"
                                        aria-labelledby="nav-table-view">

                                        <div class="row" id="dataTemplateList" data-bs-theme="dark">
                                            <template x-if="isProjectTableSelected()">
                                                <div>
                                                    <div align="center">
                                                        <button @click="updateViewRecord(-1)" type="button"
                                                            class="btn btn-primary" data-toggle="tooltip"
                                                            data-placement="left" title="Previous Record">
                                                            <i class="bi bi-arrow-left-circle"></i>
                                                        </button>

                                                        <span x-html="qfState.interface.currentViewRecord"></span> of
                                                        <span x-html="getCurrentProjectTableData().length"></span>
                                                        records

                                                        <button @click="updateViewRecord(1)" type="button"
                                                            class="btn btn-primary" data-toggle="tooltip"
                                                            data-placement="left" title="Next Record">
                                                            <i class="bi bi-arrow-right-circle"></i>
                                                            </button>
                                                    </div>
                                                    <div class="card">
                                                        <div class="card-body"
                                                            x-html="getItemCardView(qfState.interface.currentViewRecord-1)">
                                                        </div>
                                                    </div>
                                                </div>
                                            </template>
                                        </div>
                                    </div>

                                    <div class="tab-pane fade show" id="nav-table-meta" role="tabpanel"
                                        aria-labelledby="nav-table-meta-tab">
                                        <p>&nbsp;</p>
                                        <h5>Table Meta Information</h5>
                                        <template x-if="isProjectTableSelected()">
                                            <form id="formmetaform" class="row g-3">
                                                <div class="col-md-12"><label for="formname" class="form-label">
                                                        table name</label><input :value="getCurrentProjectTableName()"
                                                        type="text" class="form-control" id="formname" placeholder="">
                                                </div>
                                                <div class="col-md-12"><label for="formdesc" class="form-label">
                                                        description</label><input :value="getCurrentProjectTableDesc()"
                                                        type="text" class="form-control" id="formdesc" placeholder="">
                                                </div>
                                                <div class="col-md-12"><label for="formgridfields"
                                                        class="form-label">grid
                                                        list template</label><input
                                                        :value="getCurrentProjectTableGridFields()" type="text"
                                                        class="form-control" id="formgridfields"
                                                        placeholder="e.g. {{title}} - {{published date}}"></div>
                                                <div class="col-md-12"><label for="formuselabels" class="form-label">use
                                                        labels
                                                        for cards
                                                        view</label><select class="form-select" id="formuselabels">
                                                        <option disabled value="">Choose One...</option>
                                                        <option selected>true</option>
                                                        <option>false</option>
                                                    </select></div>
                                                <div class="col-md-12"><button @click="saveFormMetaInfo">Save</button>
                                                </div>
                                            </form>
                                        </template>
                                    </div>

                                </div>
                            </div>
                        </template>
                        <!-- End Project Form Details -->

                    </div>
                    <!-- End Project Section-->

                    <!-- Design Section -->
                    <div id="design-container" x-show="getInterfaceSection()=='design'"
                        style="margin:0,auto;text-align:left;width:90%">

                        <div class="toast-container position-fixed bottom-0 end-0 p-3">
                            <div id="liveToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true"
                                data-bs-config='{"delay":30000}'>
                                <div class="toast-body">
                                    System template has been created.
                                    <button type="button" class="btn-close" data-bs-dismiss="toast"
                                        aria-label="Close"></button>
                                </div>
                            </div>
                        </div>

                        <nav>
                            <div class="nav nav-tabs" id="nav-design-tab" role="tablist">
                                <button class="nav-link" id="nav-design-clear-tab" data-bs-toggle="tab"
                                    data-bs-target="#nav-design-clear" type="button" role="tab"
                                    aria-controls="nav-design-clear" aria-selected="true">Clear</button>
                            </div>
                        </nav>
                        <div class="tab-content" id="nav-tabContent">

                            <div class="tab-pane fade show" id="nav-design-clear" role="tabpanel"
                                aria-labelledby="nav-clear-preview-tab">
                                <p>&nbsp;</p>
                                To clear all data and all projects, aka, start all over again, click the button below:
                                <button @click="clearEverything">Clear All Data</button>
                            </div>

                        </div>

                    </div>
                    <!-- Design Section -->

                </div>

            </div>
            <!-- End Data Section -->

        </div>
    </div>
    </div>

</body>

</html>